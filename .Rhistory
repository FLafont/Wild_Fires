pacman::p_load(tidyverse,
caret,
pls,
BiocManager,
mixOmics)
train_weather <- read_csv("data/train_aggregated_weather_1_853.csv") %>% select(-1,-2) %>%
mutate(annee=str_sub(date_target,1,4),
geoid = ifelse(nchar(geoid)<5,paste0("0",geoid),geoid))
pacman::p_load(tidyverse)
train_weather <- read_csv("data/train_aggregated_weather_1_853.csv") %>% select(-1,-2) %>%
mutate(annee=str_sub(date_target,1,4),
geoid = ifelse(nchar(geoid)<5,paste0("0",geoid),geoid))
pacman::p_load(tidyverse)
pacman::p_load(tidyverse)
train_weather <- read_csv("data/train_aggregated_weather_1_853.csv") %>% select(-1,-2) %>%
mutate(annee=str_sub(date_target,1,4),
geoid = ifelse(nchar(geoid)<5,paste0("0",geoid),geoid))
data_train <- read_csv("data/semaine_train.csv")
magic <- left_join(data_train,train_weather %>% select(-week,-annee),
by = c("county"="geoid",
"date_semaine"="date_target"))
rm(data_train, train_weather)
ssize <- 2000
sub_train <- sample_n(magic, ssize)
sub_train <- sub_train[complete.cases(sub_train),]
colnames(sub_train)
FIRE <- sub_train$FIRE
sub_train <- sub_train[,keep]
keep <- c("X11_Open_water",
"X21_Developed_open_space",
"X22_Developed_low_intensity",
"X23_Developed_medium_intensity",
"X24_Developed_high_intensity",
"X31_Barren_land_rock_sand_clay",
"X41_Deciduous_forest",
"X42_Evergreen_forest",
"X43_Mixed_forest",
"X52_Shrub_scrub",
"X71_Grassland_herbaceous",
"X81_Pasture_hay",
"X82_Cultivated_crops",
"X90_Woody_wetlands",
"X95_Emergent_herbaceous_wetlands",
"X0_0",
"X12_Perennial_ice_snow",
"pop_year",
"nb_feux_voisins",
"nb_feux_voisins_lag",
"av_temp_hi",
"av_temp_lo",
"av_temp_mean",
"av_precip",
"av_wind_speed",
"av_cloud_cover",
"av_humidity")
sub_train <- sub_train[,keep]
pacman::p_load(mixOmics)
df_scaled <- scale(sub_train)
tune.splsda <- tune.splsda(X = df_scaled,
Y = FIRE,
ncomp = 2,
validation = 'Mfold',    ##change to 'loo' for leave one out
progressBar = TRUE,
dist = 'max.dist',
test.keepX = list.keepX,
nrepeat = 100) #nrepeat 50-100 for better estimate
FIRE <- as.character(FIRE)
tune.splsda <- tune.splsda(X = df_scaled,
Y = FIRE,
ncomp = 2,
validation = 'Mfold',    ##change to 'loo' for leave one out
progressBar = TRUE,
dist = 'max.dist',
test.keepX = list.keepX,
nrepeat = 100) #nrepeat 50-100 for better estimate
list.keepX <- c(seq(2, 20, 1))
set.seed(2543)
tune.splsda <- tune.splsda(X = df_scaled,
Y = FIRE,
ncomp = 2,
validation = 'Mfold',    ##change to 'loo' for leave one out
progressBar = TRUE,
dist = 'max.dist',
test.keepX = list.keepX,
nrepeat = 100) #nrepeat 50-100 for better estimate
res2 <- splsda(X = df_scaled,
Y = FIRE,
mode = "regression",
ncomp = 2,
keepX = tune.splsda$choice.keepX)
?splsda
res2 <- splsda(X = df_scaled,
Y = FIRE,
ncomp = 2,
keepX = tune.splsda$choice.keepX)
plotIndiv(res2, ind.names = habillage,
ellipse = F, legend =TRUE,col.per.group = 1:3,star = F,
title = "Fire caracterisation")
plotIndiv(res2, ind.names = keep,
ellipse = F, legend =TRUE,col.per.group = 1:3,star = F,
title = "Fire caracterisation")
plotIndiv(res2, ind.names = df_scaled,
ellipse = F, legend =TRUE,col.per.group = 1:3,star = F,
title = "Fire caracterisation")
plotIndiv(res2,
ellipse = F, legend =TRUE,col.per.group = 1:3,star = F,
title = "Fire caracterisation")
plotIndiv(res2)
plotVar(res2)
res2$keepA
res2$keepX
summary(res2)
res2
res2$names
res2$loadings
pacman::p_load(tidyverse)
train_weather <- read_csv("data/train_aggregated_weather_1_853.csv") %>% select(-1,-2) %>%
mutate(annee=str_sub(date_target,1,4),
geoid = ifelse(nchar(geoid)<5,paste0("0",geoid),geoid))
pacman::p_load(tidyverse)
train_weather <- read_csv("data/train_aggregated_weather_1_853.csv") %>% select(-1,-2) %>%
mutate(annee=str_sub(date_target,1,4),
geoid = ifelse(nchar(geoid)<5,paste0("0",geoid),geoid))
